<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sales TV (Screenshots)</title>
  <style>
    html, body { margin:0; height:100%; background:#000; overflow:hidden; }

    img {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      object-fit: contain; /* change to cover if you want full screen */
      background: #000;
      opacity: 0;
      transition: opacity 250ms linear;
    }
    img.show { opacity: 1; }
  </style>
</head>
<body>
  <img id="a" class="show" />
  <img id="b" />

  <script>
    const SLIDE_MS = 150000; // 2m30s

    const a = document.getElementById("a");
    const b = document.getElementById("b");

    let slides = [];
    let idx = 0;
    let activeIsA = true;

    function active() { return activeIsA ? a : b; }
    function hidden() { return activeIsA ? b : a; }

    function swapVisible() {
      activeIsA = !activeIsA;
      a.classList.toggle("show", activeIsA);
      b.classList.toggle("show", !activeIsA);
    }

    async function loadManifest() {
      const res = await fetch("shots/manifest.json?cb=" + Date.now());
      slides = await res.json();
    }

    function setImg(img, file) {
      // Cache-bust so Fire TV always fetches newest screenshots after updates
      img.src = file + "?cb=" + Date.now();
    }

    function preloadNext() {
      const next = (idx + 1) % slides.length;
      setImg(hidden(), slides[next].file);
    }

    function nextSlide() {
      idx = (idx + 1) % slides.length;
      swapVisible();
      preloadNext();
    }

    (async () => {
      await loadManifest();
      if (!slides.length) return;

      // initial load
      setImg(a, slides[0].file);
      setImg(b, slides[1 % slides.length].file);

      setInterval(nextSlide, SLIDE_MS);
    })();
  </script>
</body>
</html>
